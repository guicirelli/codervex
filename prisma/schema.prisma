// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(cuid())
  email         String    @unique
  name          String?
  password      String
  credits       Int       @default(0)
  subscription  String?   @default("free") // free, monthly, pay-per-use
  stripeId      String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  prompts       Prompt[]
  payments      Payment[]
}

model Prompt {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  title       String?
  content     String   @db.Text
  projectType String?
  stack       String?
  status      String   @default("completed") // processing, completed, failed
  isPublic    Boolean  @default(false) // Para comunidade open source
  sourceType  String   @default("upload") // upload, idea, reference
  isFavorite  Boolean  @default(false) // Favorito do usu√°rio
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Payment {
  id            String   @id @default(cuid())
  userId        String
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  stripeId      String   @unique
  amount        Int
  currency      String   @default("usd")
  status        String   // succeeded, pending, failed
  type          String   // one-time, subscription
  createdAt     DateTime @default(now())
}

